(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-01849ab8"],{2680:function(e,t,s){"use strict";s.d(t,"a",(function(){return n})),s.d(t,"b",(function(){return c})),s.d(t,"c",(function(){return o})),s.d(t,"e",(function(){return l})),s.d(t,"h",(function(){return d})),s.d(t,"j",(function(){return u})),s.d(t,"d",(function(){return v})),s.d(t,"f",(function(){return m})),s.d(t,"g",(function(){return f})),s.d(t,"i",(function(){return _}));var a=s("5530"),i=s("bc07"),r="/v1/order_service";function n(e,t){return Object(i["a"])({url:r,method:"post",data:{method:"add.order.service.message",service_no:e,message:t}})}function c(e){return Object(i["a"])({url:r,method:"post",data:{method:"get.order.service.item",service_no:e}})}function o(e){return Object(i["a"])({url:r,method:"post",data:Object(a["a"])({method:"get.order.service.list"},e)})}function l(e){return Object(i["a"])({url:r,method:"post",data:{method:"set.order.service.agree",service_no:e}})}function d(e,t){return Object(i["a"])({url:r,method:"post",data:{method:"set.order.service.refused",service_no:e,result:t}})}function u(e,t){return Object(i["a"])({url:r,method:"post",data:{method:"set.order.service.sendback",service_no:e,is_return:t}})}function v(e){return Object(i["a"])({url:r,method:"post",data:{method:"set.order.service.after",service_no:e}})}function m(e){return Object(i["a"])({url:r,method:"post",data:{method:"set.order.service.cancel",service_no:e}})}function f(e){return Object(i["a"])({url:r,method:"post",data:Object(a["a"])({method:"set.order.service.complete"},e)})}function _(e){return Object(i["a"])({url:r,method:"post",data:Object(a["a"])({method:"set.order.service.remark"},e)})}},"2edc":function(e,t,s){"use strict";s.d(t,"a",(function(){return n})),s.d(t,"g",(function(){return c})),s.d(t,"c",(function(){return o})),s.d(t,"d",(function(){return l})),s.d(t,"e",(function(){return d})),s.d(t,"f",(function(){return u})),s.d(t,"b",(function(){return v}));var a=s("5530"),i=s("bc07"),r="/v1/delivery_item";function n(e){return Object(i["a"])({url:r,method:"post",data:Object(a["a"])({method:"add.delivery.company.item"},e)})}function c(e){return Object(i["a"])({url:r,method:"post",data:Object(a["a"])({method:"set.delivery.company.item"},e)})}function o(e){return Object(i["a"])({url:r,method:"post",data:{method:"del.delivery.company.list",delivery_item_id:e}})}function l(e){return Object(i["a"])({url:r,method:"post",data:{method:"get.delivery.company.item",delivery_item_id:e}})}function d(e){return Object(i["a"])({url:r,method:"post",data:Object(a["a"])({method:"get.delivery.company.list"},e)})}function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return Object(i["a"])({url:r,method:"post",data:{method:"get.delivery.company.select",type:e}})}function v(e){return Object(i["a"])({url:r,method:"post",data:{method:"copy.delivery.company.hot",delivery_item_id:e}})}},"3a6f":function(e,t,s){"use strict";s("5916")},"4e03":function(e,t,s){"use strict";s("caad"),s("a434"),s("b0c0"),s("a9e3"),s("d3b7");var a=s("5530"),i=s("2680"),r=s("ca00"),n=s("2edc");t["a"]={components:{csDeliveryDist:function(){return s.e("chunk-7619cb4b").then(s.bind(null,"3b44"))}},data:function(){return{currentTableData:[],auth:{message:!1,agree:!1,refused:!1,sendback:!1,after:!1,cancel:!1,complete:!1,remark:!1,dist:!1},delivery:[],statusMap:{0:"全部",1:"待处理",2:"已同意",3:"已拒绝",4:"已寄件",5:"售后中",6:"已撤销",7:"已完成"},deliveryMap:{0:{text:"待发货",color:"#303133"},1:{text:"已发货",color:"#67C23A"},2:{text:"已收货",color:"#67C23A"},3:{text:"已取消",color:"#F56C6C"}},goodsMap:{0:"未选择",1:"未收到货",2:"已收到货"},rules:{complete:{result:[{max:100,message:"长度不能大于 100 个字符",trigger:"blur"}],logistic_code:[{required:!0,message:"快递单号不能为空",trigger:"blur"},{max:50,message:"长度不能大于 50 个字符",trigger:"blur"}]}},formRemark:{index:void 0,loading:!1,visible:!1,request:{}},formComplete:{index:void 0,loading:!1,visible:!1,request:{}}}},filters:{getPreviewUrl:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"goods_image_x80";return e?r["a"].getImageCodeUrl(e,t):""},getNumber:function(e){return r["a"].getNumber(e)},getUserName:function(e){if(e.username)return e.username===r["a"].cookies.get("uuid")?"我的工单":"".concat(e.username," 的工单")}},mounted:function(){this._validationAuth()},methods:{_validationAuth:function(){this.auth.message=this.$permission("/order/service/list/message"),this.auth.agree=this.$permission("/order/service/list/agree"),this.auth.refused=this.$permission("/order/service/list/refused"),this.auth.sendback=this.$permission("/order/service/list/sendback"),this.auth.after=this.$permission("/order/service/list/after"),this.auth.cancel=this.$permission("/order/service/list/cancel"),this.auth.complete=this.$permission("/order/service/list/complete"),this.auth.remark=this.$permission("/order/service/list/remark"),this.auth.dist=this.$permission("/order/service/list/dist")},_getServiceColor:function(e){if(e&&e.username===r["a"].cookies.get("uuid"))return"color: #E6A23C;"},_whetherToConfirm:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"warning",s={confirmButtonText:"确定",cancelButtonText:"取消",closeOnClickModal:!1,type:t},a=e||"确定要执行该操作吗?";return this.$confirm(a,"提示",s)},handleOpenDelivery:function(){var e=this;this.delivery.length||Object(n["f"])(0).then((function(t){e.delivery=t.data||[]}))},handleView:function(e){this.$router.push({name:"goods-admin-view",params:{goods_id:e}})},handleOrder:function(e){this.$router.push({name:"order-admin-info",params:{order_no:e}})},handleDist:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this.$refs.deliveryDist&&("string"===typeof s&&(s=s?[s]:[]),this.$refs.deliveryDist.show(e,t,s))},setServiceRemark:function(e){var t=this.currentTableData[e];this.formRemark={index:e,loading:!1,visible:!0,request:{service_no:t.service_no,remark:t.remark}}},handleServiceRemark:function(){var e=this;this.formRemark.loading=!0;var t=this.formRemark.index;Object(i["i"])(this.formRemark.request).then((function(){e.currentTableData[t].remark=e.formRemark.request.remark,e.formRemark.visible=!1,e.$message.success("操作成功")})).catch((function(){e.formRemark.loading=!1}))},handleServiceAgree:function(e){var t=this;this._whetherToConfirm().then((function(){var s=t.currentTableData[e];Object(i["e"])(s.service_no).then((function(i){"order-service-info"!==t.$options.name?"0"===t.tabPane?t.$set(t.currentTableData,e,Object(a["a"])(Object(a["a"])(Object(a["a"])({},s),i.data),{},{admin_event:0,get_admin:{username:r["a"].cookies.get("uuid")}})):(t.currentTableData.splice(e,1),t.currentTableData.length<=0&&t.$emit("refresh",!0)):t.getServiceData()})).then((function(){t.$message.success("操作成功")}))})).catch((function(){}))},handleServiceRefused:function(e){var t=this;this.$prompt("请输入拒绝原因","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/\S/,inputErrorMessage:"请输入拒绝原因"}).then((function(s){var n=s.value,c=t.currentTableData[e];Object(i["h"])(c.service_no,n).then((function(s){"order-service-info"!==t.$options.name?"0"===t.tabPane?t.$set(t.currentTableData,e,Object(a["a"])(Object(a["a"])(Object(a["a"])({},c),s.data),{},{admin_event:0,get_admin:{username:r["a"].cookies.get("uuid")}})):(t.currentTableData.splice(e,1),t.currentTableData.length<=0&&t.$emit("refresh",!0)):t.getServiceData()})).then((function(){t.$message.success("操作成功")}))})).catch((function(){}))},handleServiceSendback:function(e){var t=this;this._whetherToConfirm().then((function(){var s=t.currentTableData[e],r=Number(!s.is_return);Object(i["j"])(s.service_no,r).then((function(){"order-service-info"!==t.$options.name?t.$set(t.currentTableData,e,Object(a["a"])(Object(a["a"])({},s),{},{is_return:r,admin_event:0})):t.getServiceData()})).then((function(){t.$message.success("操作成功")}))})).catch((function(){}))},handleServiceAfter:function(e){var t=this;this._whetherToConfirm().then((function(){var s=t.currentTableData[e];Object(i["d"])(s.service_no).then((function(i){"order-service-info"!==t.$options.name?"0"===t.tabPane?t.$set(t.currentTableData,e,Object(a["a"])(Object(a["a"])(Object(a["a"])({},s),i.data),{},{admin_event:0})):(t.currentTableData.splice(e,1),t.currentTableData.length<=0&&t.$emit("refresh",!0)):t.getServiceData()})).then((function(){t.$message.success("操作成功")}))})).catch((function(){}))},handleServiceCancel:function(e){var t=this;this._whetherToConfirm().then((function(){var s=t.currentTableData[e];Object(i["f"])(s.service_no).then((function(i){"order-service-info"!==t.$options.name?"0"===t.tabPane?t.$set(t.currentTableData,e,Object(a["a"])(Object(a["a"])(Object(a["a"])({},s),i.data),{},{admin_event:0})):(t.currentTableData.splice(e,1),t.currentTableData.length<=0&&t.$emit("refresh",!0)):t.getServiceData()})).then((function(){t.$message.success("操作成功")}))})).catch((function(){}))},setServiceComplete:function(e){var t=this,s=this.currentTableData[e];this.formComplete={index:e,loading:!1,visible:!1,request:{type:s.type,service_no:s.service_no,delivery_item_id:void 0,logistic_code:void 0,result:void 0}},this.$nextTick((function(){t.$refs.formComplete&&t.$refs.formComplete.clearValidate(),t.formComplete.visible=!0}))},handleServiceComplete:function(){var e=this;this.$refs.formComplete.validate((function(t){if(t){var s=e.formComplete.request;if([2,3].includes(s.type)&&!s.delivery_item_id)return void e.$message.error("请选择快递公司");e.formComplete.loading=!0;var r=e.formComplete.index;Object(i["g"])(s).then((function(t){"order-service-info"!==e.$options.name?"0"===e.tabPane?e.$set(e.currentTableData,r,Object(a["a"])(Object(a["a"])(Object(a["a"])({},e.currentTableData[r]),t.data),{},{admin_event:0})):(e.currentTableData.splice(r,1),e.currentTableData.length<=0&&e.$emit("refresh",!0)):e.getServiceData(),e.formComplete.visible=!1,e.$message.success("操作成功")})).catch((function(){e.formComplete.loading=!1}))}}))}}}},5916:function(e,t,s){},d22e:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("cs-container",[s("div",{staticClass:"cs-p"},[s("el-card",{staticClass:"box-card",attrs:{shadow:"never"}},[s("el-row",[s("el-col",{staticClass:"service-left cs-pr",attrs:{span:9}},[s("p",{staticClass:"card-title"},[e._v("售后信息")]),s("div",{staticClass:"service-info"},[s("div",{staticClass:"dt"},[e._v("创建日期")]),s("div",{staticClass:"dd"},[e._v(e._s(e.serviceData.create_time))])]),s("div",{staticClass:"service-info"},[s("div",{staticClass:"dt"},[e._v("售后单号")]),s("div",{staticClass:"dd"},[e._v(e._s(e.serviceData.service_no))])]),s("div",{staticClass:"service-info"},[s("div",{staticClass:"dt"},[e._v("订单号")]),s("div",{staticClass:"dd"},[s("span",{staticClass:"link",on:{click:function(t){return e.handleOrder(e.serviceData.order_no)}}},[e._v(e._s(e.serviceData.order_no))])])]),e.serviceData.get_admin?s("div",{staticClass:"service-info"},[s("div",{staticClass:"dt"},[e._v("处理人员")]),s("div",{staticClass:"dd"},[s("span",{style:e._getServiceColor(e.serviceData.get_admin)},[e._v(" "+e._s(e._f("getUserName")(e.serviceData.get_admin))+" ")])])]):e._e(),s("div",{staticClass:"service-info"},[s("div",{staticClass:"dt"},[e._v("买家")]),s("div",{staticClass:"dd"},[s("span",[e._v(e._s(e.serviceData.get_user.username))]),e.serviceData.get_user.level_icon?s("el-image",{staticClass:"level-icon",attrs:{src:e.serviceData.get_user.level_icon,fit:"fill"}},[s("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[s("i",{staticClass:"el-icon-picture-outline"})])]):e._e()],1)]),e.serviceData.goods_status?s("div",{staticClass:"service-info"},[s("div",{staticClass:"dt"},[e._v("收货状态")]),s("div",{staticClass:"dd"},[e._v(e._s(e.goodsMap[e.serviceData.goods_status]))])]):e._e(),s("div",{staticClass:"service-info"},[s("div",{staticClass:"dt"},[e._v("售后原因")]),s("div",{staticClass:"dd"},[e._v(e._s(e.serviceData.reason))])]),e.serviceData.description?s("div",{staticClass:"service-info"},[s("div",{staticClass:"dt"},[e._v("详细说明")]),s("div",{staticClass:"dd"},[e._v(e._s(e.serviceData.description))])]):e._e(),e.serviceData.image.length?s("div",{staticClass:"service-info"},[s("div",{staticClass:"dt"},[e._v("凭证照片")]),s("div",{staticClass:"dd",staticStyle:{"line-height":"0"}},e._l(e.serviceData.image,(function(t,a){return s("el-image",{key:a,staticClass:"image_thumb",attrs:{src:e._f("getPreviewUrl")(t.source,"comment_thumb_x40"),fit:"cover"},on:{click:function(t){return t.stopPropagation(),e.$preview(e.serviceData.image,a)}}})})),1)]):e._e(),s("el-divider"),e.serviceData.is_return?[s("div",{staticClass:"service-info"},[s("div",{staticClass:"dt"},[e._v("是否寄回")]),s("div",{staticClass:"dd"},[e.serviceData.logistic_code?[s("span",[e._v("快递单号：")]),s("span",{staticClass:"link",on:{click:function(t){return e.handleDist(e.serviceData.service_no,e.serviceData.logistic_code)}}},[e._v(e._s(e.serviceData.logistic_code))])]:[e._v(" 买家尚未填写返件信息 ")]],2)]),e.serviceData.address?[s("div",{staticClass:"service-info"},[s("div",{staticClass:"dt"},[e._v("寄件人")]),s("div",{staticClass:"dd"},[e._v(e._s(e.serviceData.consignee))])]),s("div",{staticClass:"service-info"},[s("div",{staticClass:"dt"},[e._v("手机号")]),s("div",{staticClass:"dd"},[e._v(e._s(e.serviceData.mobile))])]),s("div",{staticClass:"service-info"},[s("div",{staticClass:"dt"},[e._v("寄件地址")]),s("div",{staticClass:"dd"},[e._v(e._s(e.serviceData.address))])]),s("div",{staticClass:"service-info"},[s("div",{staticClass:"dt"},[e._v("邮编")]),s("div",{staticClass:"dd"},[e._v(e._s(e.serviceData.zipcode))])])]:e._e()]:e._e(),e.serviceData.refund_no?s("div",{staticClass:"service-info"},[s("div",{staticClass:"dt"},[e._v("退款单号")]),s("div",{staticClass:"dd"},[s("span",{staticClass:"link",on:{click:function(t){return e.handleRefund(e.serviceData.refund_no)}}},[e._v(e._s(e.serviceData.refund_no))])])]):e._e(),e.serviceData.result?s("div",{staticClass:"service-info"},[s("div",{staticClass:"dt"},[e._v("处理结果")]),s("div",{staticClass:"dd"},[e._v(e._s(e.serviceData.result))])]):e._e(),s("div",{staticClass:"service-info"},[s("div",{staticClass:"dt"},[e._v("卖家备注")]),s("div",{staticClass:"dd"},[e._v(e._s(e.serviceData.remark))])])],2),s("el-col",{staticClass:"cs-pl",attrs:{span:15}},[s("p",{staticClass:"card-title"},[e._v("售后状态")]),s("el-steps",{attrs:{active:e.tradeStatus.active,"process-status":e.tradeStatus.process_status,"finish-status":e.tradeStatus.finish_status,"align-center":!0}},e._l(e.tradeStatus.step,(function(e,t){return s("el-step",{key:t,attrs:{title:e.title,icon:e.icon}})})),1),s("el-divider"),s("div",{staticStyle:{display:"inline-flex"}},[e.auth.message?s("el-button",{attrs:{size:"small"},on:{click:e.toMessage}},[e._v("留言")]):e._e(),e.auth.remark?s("el-button",{attrs:{size:"small"},on:{click:function(t){return e.setServiceRemark(0)}}},[e._v("备注")]):e._e(),[2,3].includes(e.serviceData.type)&&6===e.serviceData.status&&e.auth.dist?s("el-button",{attrs:{size:"small"},on:{click:function(t){return e.handleDist(e.serviceData.service_no,null,e.serviceData.logistic_code)}}},[e._v("物流信息")]):e._e(),0===e.serviceData.status&&e.auth.agree?s("el-button",{attrs:{size:"small"},on:{click:function(t){return e.handleServiceAgree(0)}}},[e._v("同意售后")]):e._e(),0===e.serviceData.status&&e.auth.refused?s("el-button",{attrs:{size:"small"},on:{click:function(t){return e.handleServiceRefused(0)}}},[e._v("拒绝售后")]):e._e(),0!==e.serviceData.type&&1===e.serviceData.status&&!e.serviceData.logistic_code&&e.auth.sendback?s("el-button",{attrs:{size:"small"},on:{click:function(t){return e.handleServiceSendback(0)}}},[e._v(e._s(e.serviceData.is_return?"撤销寄回":"要求寄回"))]):e._e(),(0===e.serviceData.type&&1===e.serviceData.status||3===e.serviceData.status)&&e.auth.after?s("el-button",{attrs:{size:"small"},on:{click:function(t){return e.handleServiceAfter(0)}}},[e._v("设为售后中")]):e._e(),[1,3,4].includes(e.serviceData.status)&&e.auth.cancel?s("el-button",{attrs:{size:"small"},on:{click:function(t){return e.handleServiceCancel(0)}}},[e._v("撤销售后")]):e._e(),4===e.serviceData.status&&e.auth.complete?s("el-button",{attrs:{size:"small"},on:{click:function(t){return e.setServiceComplete(0)}}},[e._v("售后完成")]):e._e()],1)],1)],1),s("el-collapse",{attrs:{value:["goods","log"]}},[s("el-collapse-item",{attrs:{title:"售后商品",name:"goods"}},[s("el-table",{staticStyle:{"margin-top":"-15px"},attrs:{data:e.serviceData.get_order_goods}},[s("el-table-column",{attrs:{label:"商品","min-width":"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-image",{staticClass:"goods-image",attrs:{src:e._f("getPreviewUrl")(t.row.goods_image),fit:"contain",lazy:""},on:{click:function(s){return e.handleView(t.row.goods_id)}}}),s("div",{staticClass:"goods-info"},[s("span",{staticClass:"name",attrs:{title:t.row.goods_name},on:{click:function(s){return e.handleView(t.row.goods_id)}}},[e._v(e._s(t.row.goods_name))]),s("p",{staticClass:"specs"},[e._v(e._s(t.row.key_value))])])]}}])}),s("el-table-column",{attrs:{label:"商品状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",{style:{color:e.deliveryMap[t.row.status].color}},[e._v(" "+e._s(e.deliveryMap[t.row.status].text)+" ")])]}}])}),s("el-table-column",{attrs:{label:"申请数量"}},[s("span",[e._v(e._s(e.serviceData.qty))])]),s("el-table-column",{attrs:{label:"类型"}},[s("span",[e._v(e._s(e.typeMap[e.serviceData.type]))])]),s("el-table-column",{attrs:{label:"状态"}},[s("span",[e._v(e._s(e.statusMap[e.serviceData.status+1]))])])],1),e.serviceData.refund_fee?s("div",{staticClass:"cs-fr cs-p"},[s("div",{class:{"service-info":!0,"cs-pb":e.isRefundOther()}},[s("div",{staticClass:"dt"},[e._v("申请金额")]),s("div",{staticClass:"dd number"},[e._v(e._s(e._f("getNumber")(e.serviceData.refund_fee)))])]),e.serviceData.refund_detail?[e.serviceData.refund_detail.money_amount?s("div",{staticClass:"service-info"},[s("div",{staticClass:"dt"},[e._v("退回余额")]),s("div",{staticClass:"dd number"},[e._v(e._s(e._f("getNumber")(e.serviceData.refund_detail.money_amount)))])]):e._e(),e.serviceData.refund_detail.integral_amount?s("div",{staticClass:"service-info"},[s("div",{staticClass:"dt"},[e._v("退回积分")]),s("div",{staticClass:"dd number"},[e._v(e._s(e._f("getNumber")(e.serviceData.refund_detail.integral_amount)))])]):e._e(),e.serviceData.refund_detail.card_amount?s("div",{staticClass:"service-info"},[s("div",{staticClass:"dt"},[e._v("退回购物卡")]),s("div",{staticClass:"dd number"},[e._v(e._s(e._f("getNumber")(e.serviceData.refund_detail.card_amount)))])]):e._e(),e.serviceData.refund_detail.payment_amount?s("div",{staticClass:"service-info"},[s("div",{staticClass:"dt"},[e._v("退回在线支付")]),s("div",{staticClass:"dd number"},[e._v(e._s(e._f("getNumber")(e.serviceData.refund_detail.payment_amount)))])]):e._e()]:e._e(),e.serviceData.delivery_fee?s("div",{staticClass:"service-info"},[s("div",{staticClass:"dt"},[e._v("退回运费")]),s("div",{staticClass:"dd number"},[e._v(e._s(e._f("getNumber")(e.serviceData.delivery_fee)))])]):e._e()],2):e._e()],1),s("el-collapse-item",{attrs:{title:"售后日志",name:"log",id:"msg-form"}},[s("el-timeline",e._l(e.serviceData.get_service_log,(function(t,a){return s("el-timeline-item",{key:a,attrs:{type:t.client_type?"danger":"primary",timestamp:t.create_time}},[s("div",{staticClass:"service-log"},[s("li",[s("span",[e._v("["+e._s(e.clientMap[t.client_type])+"]")]),e._v(" "+e._s(t.action))]),s("li",{staticClass:"comment"},[e._v(e._s(t.description+"："+t.comment))])])])})),1),s("el-form",{ref:"msgForm",attrs:{model:e.msgForm,rules:e.msgRules,"label-width":"68px",id:"add-message"}},[s("el-form-item",{attrs:{prop:"message"}},[s("el-input",{attrs:{placeholder:"您可以输入售后单留言，顾客在日志中可看到",type:"textarea",autosize:{minRows:5},"show-word-limit":!0,maxlength:"255"},model:{value:e.msgForm.message,callback:function(t){e.$set(e.msgForm,"message",t)},expression:"msgForm.message"}}),s("el-button",{staticClass:"cs-mt-10",attrs:{type:"primary",loading:e.msgLoading,size:"small"},on:{click:e.handleMessage}},[e._v("提交")])],1)],1)],1)],1)],1)],1),s("el-dialog",{attrs:{title:"卖家备注",visible:e.formRemark.visible,"append-to-body":!0,"close-on-click-modal":!1,width:"600px"},on:{"update:visible":function(t){return e.$set(e.formRemark,"visible",t)}}},[s("el-input",{attrs:{type:"textarea",rows:6,placeholder:"编辑卖家备注，仅卖家自己可见",maxlength:"255","show-word-limit":""},model:{value:e.formRemark.request.remark,callback:function(t){e.$set(e.formRemark.request,"remark",t)},expression:"formRemark.request.remark"}}),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{size:"small"},on:{click:function(t){e.formRemark.visible=!1}}},[e._v("取消")]),s("el-button",{attrs:{type:"primary",loading:e.formRemark.loading,size:"small"},on:{click:e.handleServiceRemark}},[e._v("确定")])],1)],1),s("el-dialog",{attrs:{title:"售后完成",visible:e.formComplete.visible,"append-to-body":!0,"close-on-click-modal":!1,width:"600px"},on:{"update:visible":function(t){return e.$set(e.formComplete,"visible",t)},open:e.handleOpenDelivery}},[s("el-form",{ref:"formComplete",attrs:{model:e.formComplete.request,rules:e.rules.complete,"label-width":"80px"}},[s("el-form-item",{attrs:{label:"处理结果",prop:"result"}},[s("el-input",{attrs:{placeholder:"可输入售后处理结果",clearable:!0},model:{value:e.formComplete.request.result,callback:function(t){e.$set(e.formComplete.request,"result",t)},expression:"formComplete.request.result"}})],1),[2,3].includes(e.formComplete.request.type)?s("el-form-item",{attrs:{label:"快递单号",prop:"logistic_code"}},[s("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入售后完成后寄回商品的快递单号",clearable:!0},model:{value:e.formComplete.request.logistic_code,callback:function(t){e.$set(e.formComplete.request,"logistic_code",t)},expression:"formComplete.request.logistic_code"}},[s("el-select",{staticStyle:{width:"150px"},attrs:{slot:"prepend",placeholder:"请选择"},slot:"prepend",model:{value:e.formComplete.request.delivery_item_id,callback:function(t){e.$set(e.formComplete.request,"delivery_item_id",t)},expression:"formComplete.request.delivery_item_id"}},e._l(e.delivery,(function(e,t){return s("el-option",{key:t,attrs:{label:e.name,value:e.delivery_item_id}})})),1)],1)],1):e._e()],1),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{size:"small"},on:{click:function(t){e.formComplete.visible=!1}}},[e._v("取消")]),s("el-button",{attrs:{type:"primary",loading:e.formComplete.loading,size:"small"},on:{click:e.handleServiceComplete}},[e._v("确定")])],1)],1),s("cs-order-refund",{attrs:{"refund-no":e.refundNo},model:{value:e.refundVisible,callback:function(t){e.refundVisible=t},expression:"refundVisible"}}),s("cs-delivery-dist",{ref:"deliveryDist"})],1)},i=[],r=(s("d3b7"),s("4e03")),n=s("2680"),c={name:"order-service-info",mixins:[r["a"]],components:{csOrderRefund:function(){return s.e("chunk-7bce4297").then(s.bind(null,"6d2c"))}},props:{service_no:{type:String,required:!0}},data:function(){return{serviceData:{image:[],refund_detail:{},get_user:{},get_admin:null,get_order_goods:[],get_service_log:[]},msgForm:{},msgLoading:!1,msgRules:{message:[{required:!0,message:"留言内容不能为空",trigger:"blur"},{max:255,message:"长度不能大于 255 个字符",trigger:"blur"}]},typeMap:{0:"仅退款",1:"退货退款",2:"换货",3:"维修"},clientMap:{"-1":"游客",0:"顾客",1:"商家"},refundNo:"",refundVisible:!1,tradeStatus:{}}},watch:{service_no:{handler:function(){this.getServiceData()},immediate:!0}},methods:{_setTradeStatus:function(){switch(this.tradeStatus={active:1,step:[{icon:"el-icon-edit-outline",title:"申请售后"},{icon:"el-icon-user",title:"等待处理"},{icon:"el-icon-loading",title:"售后中"},{icon:"el-icon-time",title:"售后完成"}]},this.serviceData.status){case 2:this.tradeStatus.process_status="wait",this.tradeStatus.finish_status="wait";break;case 5:case 6:this.tradeStatus.process_status="finish",this.tradeStatus.finish_status="finish";break;default:this.tradeStatus.process_status="process",this.tradeStatus.finish_status="finish"}switch(this.serviceData.status){case 6:case 5:this.tradeStatus.active=3;break;case 4:case 3:case 1:this.tradeStatus.active=2;break;default:this.tradeStatus.active=1}},isRefundOther:function(){if(this.serviceData.delivery_fee>0)return!0;for(var e in this.serviceData.refund_detail)if(Object.prototype.hasOwnProperty.call(this.serviceData.refund_detail,e)&&this.serviceData.refund_detail[e]>0)return!0;return!1},getServiceData:function(){var e=this;Object(n["b"])(this.service_no).then((function(t){var s=t.data||{};s.get_order_goods=s.get_order_goods?[s.get_order_goods]:[],e.serviceData=s,e.currentTableData=[e.serviceData],e._setTradeStatus()}))},handleMessage:function(){var e=this;this.$refs.msgForm.validate((function(t){t&&(e.msgLoading=!0,Object(n["a"])(e.service_no,e.msgForm.message).then((function(){e.getServiceData()})).then((function(){e.$nextTick((function(){e.msgForm={},e.$el.querySelector("#msg-form").scrollIntoView()}))})).finally((function(){e.msgLoading=!1})))}))},handleRefund:function(e){this.refundNo=e,this.refundVisible=!0},toMessage:function(){var e=this;this.$nextTick((function(){e.$el.querySelector("#add-message").scrollIntoView()}))}}},o=c,l=(s("3a6f"),s("2877")),d=Object(l["a"])(o,a,i,!1,null,"43d7699e",null);t["default"]=d.exports}}]);